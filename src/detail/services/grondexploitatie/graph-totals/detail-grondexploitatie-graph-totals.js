import { totaleBegrotingCategories, CATEGORY_LABELS } from '../categories';
import { displayFactor, precisionRound } from '../helpers';

const generateGraphData = ({ baten: { totaal } }) => (
  totaleBegrotingCategories.map((category) => {
    const item = totaal.categories[category] || {};
    const begroot = item.begroot || 0;
    const begrootValue = begroot / displayFactor;
    const begrootRounded = precisionRound(begrootValue, 1);
    const begrootTooSmallLabel = begrootValue ? '<0,05' : '';
    const begrootLabel = begrootRounded ? `${begrootRounded}`.replace('.', ',') : begrootTooSmallLabel;
    const geboekt = item.geboekt || 0;
    const geboektValue = geboekt / displayFactor;
    const geboektRounded = precisionRound(geboektValue, 1);
    const geboektTooSmallLabel = geboektValue ? '<0,05' : '';
    const geboektLabel = geboektRounded ? `${geboektRounded}`.replace('.', ',') : geboektTooSmallLabel;
    return {
      begroot,
      geboekt,
      id: category,
      name: CATEGORY_LABELS[category],
      begrootLabel,
      begrootValue,
      geboektLabel: begrootRounded && !geboektLabel ? '0' : geboektLabel,
      geboektValue
    };
  })
);

export default generateGraphData;
